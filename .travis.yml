language: node_js
node_js:
  - '12'
dist: trusty
services:
  - mongodb
env:
  matrix:
    - NODE_ENV=ci PORT=3000
    - secure: PYPfL3XoKDCnQz7/2d4ArcHy5fYonT0jJ8lyLIzWkA3Yu9o/ZRQVBNAiNRtKREIRRu+FTxPZ1KswToqlnLRPWd8JcGU1x3uoj00VKIInA92J9pxw0kDcoum+GjlSHEKlNA7Mxxx6pGsK1q6ZnsxU9YrnyjjAAYBB8zlZ1ibGS7Vvag9FbHcLScBkYuWvYS8HAPiRbNFthkWimh1yEn4ZTUnF0kNdALIccOe7rALCZ4rh/i4R9AnBNKAM54fbvA/qkDpaMOguD90wFw2gxyZxMxMfBWeGbiUYED+Mx+gRvfE3zAkUrCFDg3/Rwt7X2lAEc/NT80/s3VqS7WB55AoNxN3ZfbWR6oyq3DWwLwNVYu7wWAIWlqykJRx6WUlS7XdWRHHd6woR+6FsjwZs/Dv6j97GTayXisiOfO7YKRDuTlNMbAWs6Zefdgwk+1IDO9apYlS7BEm148VotsfKSb6HRetKmzbq1fbiv0iV1T0wot4//K5xyxGnbpiM6jzx8zSyEq9IN0TI7nh8CVjdWsn+C6JQ3abA3DgGFIDCGcZaA8UGHpf36qVnKceJy8fKWhtA5p90gPnRo1mxZbQuDeIVhWisyDhC4CGlYwAghnEX7qWz7qwTNyjaB0KwaxU04h5Lb1XtiL1YQHhWWtPnDfhbPMjycPfxsEm4brirWCbo530=
    - secure: MUg9fdv3NEvsSn93Lo7oCO9cruIZR74J44q70HfV5UGfHU0VAKYMbr6vQMQp/7BnqLfpPFIhQudfXVOY9FfGj0KViOrYzZBtvVk1JwmJUwFxVSKrKLLDQVoLOmjH3Rk93d9Jm5QsgQiyPu7bzMcRvmaG+Eb31yq/VEoLhJiHe6S84OcvHfscMLg19XhrwpceiZjbeBZ0dk40ECZGc2IMmVr2NTEqVw1REEtH6P58ML4w2WMd7UPpYt9ZwsyTAKLA1VnN7xLxJc8cSrJ3BXxXaylCEfCh5N39INUKa3ruHSnR5+lciz+3xmWdwinwvsOexyXeQ4zCjko1RgENAe+VzGgkGGkW9uoHJI8JNl8CBkw2pFGQl7hh8AP0cYprTmIsoRPY76vfpmLfU/wI02olJmFbjD2GyozhANPBD2WEEfzIYTYpY7UOsQGQh6DIOIFgozEDAbklKjuO/wTjhHyISpPSgVL+MIhoEjASAGPy9O8Y9glnofDx3o2tqCnqtHjiXJai6ElrvcwJYoQ+h7/VtWGiD0N2OBfazIgfUyIydqG/vmsYSj6uPRDPDVhwUMGPzuuOri/HO5YFBjIIhzqwEa1w74PqGAjt8tzQ3KvBzojC98D09Y1o8RO1107xQ/nPF8BjbGkmkxHeQJON6YLlvtAJGXQ3zlOhyAIclnOnD5g=
    - secure: igkUIuggKI1yGIkQ5dXJMa8aBpfGiW72rQRJciCTyfjbVMU/l5finSK0Dq0Nbq5X3BN3RH5iYBWmPDzZ4HCcgXLO2Z1O6GykIa4XGXpesD7d/64d/WekyO9j4kU1iqqrIzVH93l1w+8kCCV+9nMT7y+V/0RCmeznVHw2tor89JCurIJBZjh/tt47hSxR+jtbCA3mbh2tb78M+4Z7L0y9eW/zzkfOjWly4e5TIkZqVpesaa5HP4bfQ+/7m2iZo6HjTnTJf9sbn8gjFFusW2yGzMhg8TwDNtMLPdAcByBbbHwEtSdS7gMtBtgIlEYhpBdHHtLvj3PIcZlQx1xVSSaGC0WrHP9MHJ7ojhg3UVD+5VWTZt/4mJhudQIEPcBoPPG7KJtUWdpqsXtPYpWmJ26e+FVAmlFto6UATKj/EaSEPHgKUQ5kh4TAc/VOArHRLvLmEUvM2aTYwNhAqhQzHPhQeQS9sgaV9uL6kzak08nmYKpeH9s/MaZmUPf937HM9giE9HRhdQLMD2ZQl81ZgebnPb4hfc0HBcbRGNuUcr1U3G3NtuH9dRzfzgjQQssNFIPn24/gzQiHmg2YnAOsA/sO7R3FtuXxd8QpRjdtKrfECjpiaO/frtTiqVd7H0f9PTqrBl4h46zlSYIw1eyiHkQVrGJIVURAgq13kysDGGKyzT4=
cache:
  directories:
    - node_modules
    - client/mode_modules
    - server/node_modules
install:
  - npm run prodinstall
script:
  - nohup npm run prod &
  - sleep 3
  - npm run ci-test
